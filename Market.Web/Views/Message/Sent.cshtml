@model Market.Web.ViewModels.MessageListViewModel
@{
    ViewBag.Title = "Inbox";
}

<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <div class="page-info">
                <h2>Сообщения</h2>
                <p class="lead">Здесь отображается информация по входящим и исходящим сообщениям</p>
            </div>
            @{Html.RenderAction("AccountMenu", "Account"); }
            <div class="account-offer-container">
                @{Html.RenderPartial("_AccountMessagesMenu"); }
                @using (Html.BeginForm("Sent", "Message", null, FormMethod.Get, new { @class = "form-inline form-message-filter" }))
                {
                    <div class="form-message-filter-item">
                        @Html.TextBox("SearchString", ViewBag.CurrentFilter as string, new { @class = "form-control", placeholder = "Поиск..." })
                    </div>

                    <div class="form-message-filter-item">
                        @Html.TextBox("ReceiverName", ViewBag.ReceiverName as string, new { @class = "form-control", placeholder = "Кому:" })
                    </div>
                    <input type="submit" value="Поиск" class="btn btn-info" />
                }

                <table class="table table-hover" id="messages">
                    <tr>
                        <th>@Html.ActionLink("Кому", "Sent", "Message", new { sortOrder = ViewData["NameSortParm"], currentFilter = ViewData["SearchString"] }, null)</th>
                        <th>Сообщение</th>
                        <th class="date-table">@Html.ActionLink("Дата", "Sent", "Message", new { sortOrder = ViewData["DateSortParm"], currentFilter = ViewData["SearchString"] }, null)</th>
                        <th></th>
                    </tr>
                    @foreach (var messageGroup in Model.Messages)
                    {
                        <tr id="message-row-@messageGroup.Id">
                            <td class="clickable sender-table" data-id="@messageGroup.Id"><img class="img-circle avatar-small" src="@Url.Action("Photo", "Profile", new { UserId = messageGroup.ReceiverId })" alt="Alternate Text" />@messageGroup.ReceiverName</td>
                            <td class="clickable" id="@messageGroup.Id" data-id="@messageGroup.Id" style=" max-width: 100px;overflow: hidden;text-overflow: ellipsis; white-space: nowrap; "><span style="">@messageGroup.MessageBody</span></td>
                            @*<td>@messageGroup.</td>*@
                            <td class="clickable date-table" data-id="@messageGroup.Id" title="@messageGroup.CreatedDate.ToShortTimeString()">@messageGroup.CreatedDate.ToShortDateString()</td>

                            <td class="remove-table"><a data-id="@messageGroup.Id" id="linkdelete" class="remove-link"><img src="~/Content/Images/trash.png" class="remove-icon" /></a></td>
                            @*<td style="color:red">@Html.ActionLink("X", "DeleteStory", new { lastMessageId = messageGroup.FirstOrDefault().Id}, null)</td>*@
                        </tr>

                    }
                </table>
            </div>
        </div>
    </div>
</div>

@section scripts
{
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
    

}