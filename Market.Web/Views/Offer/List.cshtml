@using System.Globalization
@using Market.Web.ViewModels
@model OfferListViewModel

@{
    ViewBag.Title = "List";

}

<div class="container">
    <div class="row">
        <div class="col-lg-12">

            <div class="game-filter" id="game-filter">
                <div class="game-filter-item" data-game="all">
                    <a class="all-games" href="@Url.Action("List", new {game = "all" })">Все</a>
                </div>

                @foreach (var g in Model.Games)
                {
                    var url = "../../Content/Images/" + g.Value + "/Icons/" + g.Image;
                    <div class="game-filter-item" data-game="@g.Value" data-url="@Url.Action("List","Offer", new { game = g.Value })">
                        <a href="@Url.Action("List", new {game = g.Value })"><img src="@url" style="width:40px" alt="Alternate Text" title="@g.Name" /></a>
                        


                    </div>

                }

            </div>
        </div>
    </div>
    <div class="row" id="lll">

        



        <div class="col-lg-12" >
            <div class="loader" id="loader">
                <div class="cssload-container">
                    <div class="cssload-whirlpool"></div>
                </div>
            </div>
            <div id="list">
                @Html.Action("OfferList")
            </div>
            
        </div>


    </div>
</div>


<script src="@RouteJs.RouteJsHandler.HandlerUrl"></script>
@section scripts
{


    <script>

        function GetOfferList() {

            $.ajax({
                url: "/Offer/OfferList",
                contentType: "application/json",
                dataType: "json",
                type: "POST",
                data: JSON.stringify({ game: g }),


                success: function (ranks) {
                    var label, hidden;
                    var select;
                    var div;
                    var mainDiv = $("#filter-item");
                    mainDiv.empty();
                    for (var rank in ranks) {
                        div = $("<div></div>");
                        div.addClass("image-select");
                        hidden = $('<input type="hidden" name="FilterValues" value="' + ranks[rank].Value + '">');
                        label = $("<label for='Filter.Value'>" + ranks[rank].Text + "</label>")
                        select = $("<select name='FilterItemValues'></select>");
                        var defaultOption = $('<option>Выберите ранг</option>').val('empty');
                        select.append(defaultOption);
                        for (var item in ranks[rank].FilterItems) {
                            var url = "../../Content/Images/" + ranks[rank].GameValue + "/Ranks/" + ranks[rank].FilterItems[item].Image;
                            var option = $('<option data-url="' + url + '"></option>').val(ranks[rank].FilterItems[item].Value).text(ranks[rank].FilterItems[item].Name);

                            select.append(option);
                        }
                        div.append(select);
                        div.append(hidden);
                        mainDiv.append(label).append(div);

                    }
                    myfunction();
                    //var div = $('#rank');
                    //var divRank = $('<div></div>');
                    //div.empty();

                    //if (Object.keys(data).length != 0) {

                    //    divRank.addClass('form-group');


                    //    if (g == 'dota2') {
                    //        AddDota2RankFields(divRank, data, isListView);
                    //    }
                    //    else if (g == 'csgo') {
                    //        AddCsgoRankFields(divRank, data, isListView);
                    //    }
                    //    div.append(divRank);

                    //}
                },
                error: function myfunction() {
                    alert("hi");
                }
            });
        }
    </script>


    <script>
        //function test() {
        //    alert(
        //    $(this.parentNode).addClass("active");
        //}

        function submitSort(val) {

            //var form = $('#ajaxForm');

            $('#orderBy').val(val);
            $('#ajaxForm').submit();

        }
        function submitPage(val) {

            //var form = $('#ajaxForm');

            $('#Page').val(val);
            $('#ajaxForm').submit();

        }
    </script>
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>

    <script type="text/javascript" src="~/Scripts/jquery-ui.min.js"></script>
    <script type="text/javascript" src="~/Scripts/myScripts.js"></script>
    <script type="text/javascript" src="~/Scripts/Custom.js"></script>
    <script>
    $(document).ready(function () {

        $("#game-filter a").each(function () {
            if (this.href == window.location.href) {
                $(this.parentNode).addClass("active");
                return;
            }
        });


    });
    @*$(function () {
        var minPrice = parseInt('@Model.SearchingInfo.MinPrice');
        var maxPrice = parseInt('@Model.SearchingInfo.MaxPrice');

        $("#slider_price").slider({

            range: true,
            min: minPrice,
            max: maxPrice,
            values: [minPrice, maxPrice],
            slide: function (event, ui) {

                //Поле минимального значения
                $("#price").val(ui.values[0]);
                //Поле максимального значения
                $("#price2").val(ui.values[1]);
            }
        });
        //Записываем значения ползунков в момент загрузки страницы
        //То есть значения по умолчанию
        $("#price").val($("#slider_price").slider("values", 0));
        $("#price2").val($("#slider_price").slider("values", 1));
    });*@

    //$(document).ready(ajaxRanks('Model.SearchingInfo.Game', true));
    </script>
}




